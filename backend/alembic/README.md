# Alembic Database Migrations

This directory contains database migration scripts for Knowledge Mapper.

## Configuration

- **Async Support**: Configured for async SQLAlchemy using asyncio
- **Database**: PostgreSQL 15+ with asyncpg driver
- **Settings Integration**: Database URL from app.core.config.settings
- **File Naming**: Timestamp-based (YYYYMMDD_HHMM_description)

## Common Commands

```bash
# Check current migration version
alembic current

# Create new migration (autogenerate)
alembic revision --autogenerate -m "description"

# Apply all migrations
alembic upgrade head

# Rollback one migration
alembic downgrade -1

# View migration history
alembic history
```

## Important Notes

1. **Model Imports**: When adding new models, import them in `env.py` for autogenerate
2. **Review Migrations**: Always review autogenerated migrations before applying
3. **Test Rollbacks**: Test both upgrade and downgrade paths
4. **Documentation**: See /docs/migration-workflow.md for comprehensive guide

## Directory Structure

- `env.py` - Alembic environment configuration (async SQLAlchemy)
- `script.py.mako` - Template for new migration files
- `versions/` - Migration files (timestamped)
- `README.md` - This file

## For More Information

See the comprehensive migration workflow documentation at:
/docs/migration-workflow.md
